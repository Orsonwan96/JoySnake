



<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
      <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Free Bootstrap Admin Template : Binary Admin</title>
	<!-- BOOTSTRAP STYLES-->
    <link href="assets/css/bootstrap.css" rel="stylesheet" />
     <!-- FONTAWESOME STYLES-->
    <link href="assets/css/font-awesome.css" rel="stylesheet" />
        <!-- CUSTOM STYLES-->
    <link href="assets/css/custom.css" rel="stylesheet" />
   <script src="assets/js/jquery-1.10.2.js"></script>

    <script src="assets/js/bootstrap.min.js"></script>

    <script src="assets/js/jquery.metisMenu.js"></script>
 
    <script src="assets/js/custom.js"></script>
   
<script type="text/javascript" src="js/jquery-1.11.3.js"></script>
<script>
 $(document).ready(function(){
	 
			//解析update_user.html?uid1="+uid+"&pwd="+xxx;?后面每一个参数的
			function getUrlParam(name) {
				  var reg = new RegExp("(^|&)" + name + "=([^&]*)(&|$)"); //构造一个含有目标参数的正则表达式对象
				  var r = window.location.search.substr(1).match(reg); //匹配目标参数
				  if (r != null) return unescape(r[2]); return null; //返回参数值
			}
			var uid = getUrlParam("uid");
			$.ajax({
				url: "usert/userEntity.action",    //请求的url地址，获取全部roles职务的名称
			    dataType: "json",   //返回的异步数据格式为不能json，是文本格式
			    data: {"uid":uid},//需要传递给servlet的uid主键值
			    type: "post",   //请求方式，默认post	
			   	 success:function(data) {		
			   		$("#uid1").val(data.uid);
			   		$("#uicon").attr('src',data.icon)
					$("#uname").val(data.name);
			   		$("#upassword").val(data.pwd);
			   		$("#uregister_time").val(data.register_time);		   		
			   		$("#uage").val(data.age);//
			   		$("#account").val(data.account);//
			    },		   
			    error:function() {
			        //请求出错处理
			        alert("运行异常a");
			    }
			});
			
			$("#submit").click(function(){
                       var sex = $("[name='demo-radio']").filter(":checked"); 
				$.ajax({
					url: "usert/userUpdate.action",    //请求的url地址，获取全部roles职务的名称
				    dataType: "text",   //返回的异步数据格式为不能json，是文本格式
				    data:{"uid":uid,
				    	  "uname":$("#uname").val(),
				    	  "upassword":$("#upassword").val(),
				    	  "uage":$("#uage").val(),
						  "usex":sex.attr("value"),
				    	  "account":$("#account").val()
				    	},
				    type: "post",  
				    success:function(data) {
						//alert("data:"+data);
						if(data=="\"ok\""){
							//alert("update users success");
							location.href="http://localhost:8080/abc/table.html?msg="+data;
						}else{
							alert("update users error");
						}   
				    },		   
				    error:function() {
				        //请求出错处理
				        alert("运行异常n");
				    }
				});  
			});  

 });
</script>
   
</head>
<body>

    <div id="wrapper">
        <nav class="navbar navbar-default navbar-cls-top " role="navigation" style="margin-bottom: 0">
            <div class="navbar-header">
                <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".sidebar-collapse">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <a class="navbar-brand" href="index.html">Binary admin</a> 
            </div>
  <div style="color: white;
padding: 15px 50px 5px 50px;
float: right;
font-size: 16px;"> Last access : 30 May 2014 &nbsp; <a href="login.html" class="btn btn-danger square-btn-adjust">Logout</a> </div>
        </nav>   
           <!-- /. NAV TOP  -->
                <nav class="navbar-default navbar-side" role="navigation">
            <div class="sidebar-collapse">
                <ul class="nav" id="main-menu">
				<li class="text-center">
                    <img src="assets/img/find_user.png" class="user-image img-responsive"/>
					</li>
				
					
                    <li>
                        <a  href="index.html"><i class="fa fa-dashboard fa-3x"></i> Dashboard</a>
                    </li>
                      <li>
                        <a  href="ui.html"><i class="fa fa-desktop fa-3x"></i> UI Elements</a>
                    </li>
                    <li>
                        <a  href="tab-panel.html"><i class="fa fa-qrcode fa-3x"></i> Tabs & Panels</a>
                    </li>
						   <li  >
                        <a  href="chart.html"><i class="fa fa-bar-chart-o fa-3x"></i> Morris Charts</a>
                    </li>	
                      <li  >
                        <a  href="table.html"><i class="fa fa-table fa-3x"></i> Table Examples</a>
                    </li>
                    <li  >
                        <a  href="form.html"><i class="fa fa-edit fa-3x"></i> Forms </a>
                    </li>				
					<li  >
                        <a   href="login.html"><i class="fa fa-bolt fa-3x"></i> Login</a>
                    </li>	
                     <li  >
                        <a   href="registeration.html"><i class="fa fa-laptop fa-3x"></i> Registeration</a>
                    </li>	
					                   
                    <li>
                        <a href="#"><i class="fa fa-sitemap fa-3x"></i> Multi-Level Dropdown<span class="fa arrow"></span></a>
                        <ul class="nav nav-second-level">
                            <li>
                                <a href="#">Second Level Link</a>
                            </li>
                            <li>
                                <a href="#">Second Level Link</a>
                            </li>
                            <li>
                                <a href="#">Second Level Link<span class="fa arrow"></span></a>
                                <ul class="nav nav-third-level">
                                    <li>
                                        <a href="#">Third Level Link</a>
                                    </li>
                                    <li>
                                        <a href="#">Third Level Link</a>
                                    </li>
                                    <li>
                                        <a href="#">Third Level Link</a>
                                    </li>

                                </ul>
                               
                            </li>
                        </ul>
                      </li>  
                  <li  >
                        <a class="active-menu"  href="blank.html"><i class="fa fa-square-o fa-3x"></i> Blank Page</a>
                    </li>	
                </ul>
               
            </div>
            
        </nav>  
        <!-- /. NAV SIDE  -->
        <div id="page-wrapper" >
            <div id="page-inner">
                
              <section class="wrapper">
        <!-- page start-->

        <div class="row">
            <div class="col-lg-12">
                <section class="panel">
                    <header class="panel-heading">
                        Inline form 4
                    </header>
					 <form class="form-inline" id="formUser" role="form">
                    <div class="panel-body">                       
                            <div class="form-group">
                            <!-- 
          users.getUname()+" / "+users.getUpwd()+
				" / "+users.getUdid()+" / "+users.getUage()+"  //  "+users.getUid()); -->
                                <label  for="uname">Name:</label>
                                <input name="uname" type="text" class="form-control" id="uname" placeholder="Username">
                            </div>&nbsp;&nbsp;&nbsp;&nbsp;
                            <div class="form-group">
                                <label  for="upassword">Password:</label>
                                <input name="upwd" type="text" class="form-control" id="upassword" placeholder="Password">
                                 <input type="hidden" name="uid" id="userid" />
                            </div>&nbsp;&nbsp;&nbsp;&nbsp;
                            <div class="form-group">
                                <label  for="uregister_time">注册时间:</label>
                                <input name="utime" type="text" class="form-control" id="uregister_time" placeholder="Register_Time">
                               
                            
                            </div>
  					</div>
					 <div class="panel-body">                       
                            <div class="form-group">
                                <label  for="uage">Age:</label>
                                <input name="age" type="text" class="form-control" id="uage" placeholder="Username">
                            </div>&nbsp;&nbsp;&nbsp;&nbsp;
                            
                            <div class="form-group">
                                <label  for="uage">Account:</label>
                                <input name="account" type="text" class="form-control" id="account" placeholder="Username">
                            </div>&nbsp;&nbsp;&nbsp;&nbsp;
                            
                            <div class="form-group">
                               <div class="radio ">
                                                    <label>男:</label>
													<input tabindex="3" type="radio" value="男" name="demo-radio" >
                                                    
                                                </div>
												<div class="radio ">
												<label>女:</label>
                                                    <input tabindex="3" type="radio" value="女"  name="demo-radio">
                                                    
                                                </div>
                            </div>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                             

                    </div>
                    
					</form>
					<div class="panel-body">                       
                           <img id ="uicon" witdh = 200px height = 200px onclick='fileSelect(this);'>
                            <form id = "icon"  action="usert/updateuicon.action" method="post" enctype="multipart/form-data" style="width:auto;">
                                <input id = "uid1" name = "uid1"  readonly="true" style="display:none"></input>
				                <input type="file" name="fileToUpload" id="fileToUpload" onchange="fileSelected(this);" style="display:none;">
                            </form>        

                    </div>
					 <div class="panel-body">                       
                           
                            <input id="submit" type="button"  class="btn btn-primary" value="    更新    " />            

                    </div>
                </section>

            </div>
        </div>   
        
    <!-- main content end-->
</section>  
                          
    </div>
             <!-- /. PAGE INNER  -->
            </div>
         <!-- /. PAGE WRAPPER  -->
        </div>
     <!-- /. WRAPPER  -->
    <!-- SCRIPTS -AT THE BOTOM TO REDUCE THE LOAD TIME-->
    <!-- JQUERY SCRIPTS -->
    
    
</body>

<script type="text/javascript" src="js/browser.js"></script>
    <script type="text/javascript" src="js/fileinput.js"></script>
	<script type="text/javascript" src="js/fileinput_locale_zh.js"></script>
	<script src="js/jquery.form.js" type="text/javascript"></script>
	<script src="js/fileload.js" type="text/javascript"></script>
	<script type="text/javascript" src="js/bootstrap-fileupload.js"></script>
  <script type="text/javascript">
    function fileSelect(obj){
    	$("#fileToUpload").click();
    	
    }
    
    
    function fileSelected(file) {
      // 文件选择后触发次函数=
      var reader = new FileReader();  
      reader.onload = function(evt){
    	  
    	  $("#uicon").attr('src',evt.target.result)}; 
    	  reader.readAsDataURL(file.files[0]); 
    	  var formData = new FormData($("#icon")[0]);  	
			$("#icon").ajaxSubmit({
			    url: "usert/updateuicon.action",    //请求的url地址	
			    type: 'POST',  
			    data: formData, 
		        ///cache: false,  
		        //contentType: false,//"multipart/form-data"  
		        //processData: false,  
	      	    dataType: "text", 
			   	success:function(data) {
			   		if(data.indexOf("success")!=-1){	
			   			//alert("s");
			   			//location.replace("grades.html");
			   		}else{
			   			alert("失败");
			   		}
			    },		   
			    error:function() {
			        //请求出错处理
			        alert("运行异常l");
			    }
			});	
    }
  </script>
</html>
