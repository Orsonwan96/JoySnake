



<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
      <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Free Bootstrap Admin Template : Binary Admin</title>
	<!-- BOOTSTRAP STYLES-->
    <link href="assets/css/bootstrap.css" rel="stylesheet" />
     <!-- FONTAWESOME STYLES-->
    <link href="assets/css/font-awesome.css" rel="stylesheet" />
        <!-- CUSTOM STYLES-->
    <link href="assets/css/custom.css" rel="stylesheet" />
   <script src="assets/js/jquery-1.10.2.js"></script>

    <script src="assets/js/bootstrap.min.js"></script>

    <script src="assets/js/jquery.metisMenu.js"></script>
 
    <script src="assets/js/custom.js"></script>
   
<script type="text/javascript" src="js/jquery-1.11.3.js"></script>
<script>
 $(document).ready(function(){
	 
			//解析update_user.html?uid1="+uid+"&pwd="+xxx;?后面每一个参数的
			function getUrlParam(name) {
				  var reg = new RegExp("(^|&)" + name + "=([^&]*)(&|$)"); //构造一个含有目标参数的正则表达式对象
				  var r = window.location.search.substr(1).match(reg); //匹配目标参数
				  if (r != null) return unescape(r[2]); return null; //返回参数值
			}
			var pid = getUrlParam("pid");
			var num = 0;
			$.ajax({
				url: "placet/placeEntity.action",    //请求的url地址，获取全部roles职务的名称
			    dataType: "json",   //返回的异步数据格式为不能json，是文本格式
			    data: {"pid":pid},//需要传递给servlet的uid主键值
			    type: "post",   //请求方式，默认post	
			   	 success:function(data) {		
			   		$("#pid1").val(pid);
					$("#pname").val(data.pname);
			   		$("#position").val(data.position);
			   		$("#satisfaction").val(data.satisfaction);		   		
			   		$("#cost").val(data.cost);//
			   		$("#childcost").val(data.childcost);
			   		$("#startDate").val(data.startDate);
			   		$("#endDate").val(data.endDate);
			   		$("#title").val(data.title);
			   		$("#description").val(data.description);
			   		$("#startPlace").val(data.startPlace);
			   		$("#type").val(data.type);
			   		$("#discount").val(data.discount);
			   		$("#costSource").val(data.costSource);
			   		$("#time").val(data.time);//
			   		$("#px").val(data.px);
			   		$("#py").val(data.py);
			   		$("#hotel").val(data.hotel);
			   		$("#lunch").val(data.lunch);
			   		var phoarr = data.photo.split(',');
			   		for(var i in phoarr){
			   			num++;
			   			$('#placephoto').append("<img id ='" + i +"'style='cursor:pointer;margin:25px 25px 25px 25px' height='200px' width ='200px' src = 'upload/"+ phoarr[i] +"' onclick='fileSelect(this);'/>")
			   		}
			   		$("#photo").val(data.photo);
			    },		   
			    error:function() {
			        //请求出错处理
			        alert("运行异常a");
			    }
			});
			
			
			$("#submit").click(function(){
				$.ajax({
					url: "placet/placeUpdate.action",    //请求的url地址，获取全部roles职务的名称
				    dataType: "text",   //返回的异步数据格式为不能json，是文本格式
				    data:{"pid":pid,
				    	  "pname":$("#pname").val(),
				    	  "position":$("#position").val(),
				    	  "satisfaction":$("#satisfaction").val(),
				    	  "cost":$("#cost").val(),
				    	  "childcost":$("#childcost").val(),
				    	  "startDate":$("#startDate").val(),
				    	  "endDate":$("#endDate").val(),
				    	  "title":$("#title").val(),
				    	  "description":$("#description").val(),
				    	  "startPlace":$("#startPlace").val(),
				    	  "type":$("#type").val(),
				    	  "discount":$("#discount").val(),
				    	  "costSource":$("#costSource").val(),
				    	  "time":$("#time").val(),
				    	  "px":$("#px").val(),
				    	  "py":$("#py").val(),
				    	  "hotel":$("#hotel").val(),
				    	  "lunch":$("#lunch").val(),
				    	  "photo":$("#photo").val()
				    	},
				    type: "post",  
				    success:function(data) {
						//alert("data:"+data);
						if(data=="\"ok\""){
							//alert("update users success");
							location.href="http://localhost:8080/abc/travel_management.html?msg="+data;
						}else{
							alert("update users error");
						}   
				    },		   
				    error:function() {
				        //请求出错处理
				        alert("运行异常n");
				    }
				});  
			});  

 });
</script>
   
</head>
<body>

    <div id="wrapper">
        <nav class="navbar navbar-default navbar-cls-top " role="navigation" style="margin-bottom: 0">
            <div class="navbar-header">
                <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".sidebar-collapse">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <a class="navbar-brand" href="index.html">Binary admin</a> 
            </div>
  <div style="color: white;
padding: 15px 50px 5px 50px;
float: right;
font-size: 16px;"> Last access : 30 May 2014 &nbsp; <a href="login.html" class="btn btn-danger square-btn-adjust">Logout</a> </div>
        </nav>   
           <!-- /. NAV TOP  -->
                <nav class="navbar-default navbar-side" role="navigation">
            <div class="sidebar-collapse">
                <ul class="nav" id="main-menu">
				<li class="text-center">
                    <img src="assets/img/find_user.png" class="user-image img-responsive"/>
					</li>
				
					
                    <li>
                        <a  href="index.html"><i class="fa fa-dashboard fa-3x"></i> Dashboard</a>
                    </li>
                      <li>
                        <a  href="ui.html"><i class="fa fa-desktop fa-3x"></i> UI Elements</a>
                    </li>
                    <li>
                        <a  href="tab-panel.html"><i class="fa fa-qrcode fa-3x"></i> Tabs & Panels</a>
                    </li>
						   <li  >
                        <a  href="chart.html"><i class="fa fa-bar-chart-o fa-3x"></i> Morris Charts</a>
                    </li>	
                      <li  >
                        <a  href="table.html"><i class="fa fa-table fa-3x"></i> Table Examples</a>
                    </li>
                    <li  >
                        <a  href="form.html"><i class="fa fa-edit fa-3x"></i> Forms </a>
                    </li>				
					<li  >
                        <a   href="login.html"><i class="fa fa-bolt fa-3x"></i> Login</a>
                    </li>	
                     <li  >
                        <a   href="registeration.html"><i class="fa fa-laptop fa-3x"></i> Registeration</a>
                    </li>	
					                   
                    <li>
                        <a href="#"><i class="fa fa-sitemap fa-3x"></i> Multi-Level Dropdown<span class="fa arrow"></span></a>
                        <ul class="nav nav-second-level">
                            <li>
                                <a href="#">Second Level Link</a>
                            </li>
                            <li>
                                <a href="#">Second Level Link</a>
                            </li>
                            <li>
                                <a href="#">Second Level Link<span class="fa arrow"></span></a>
                                <ul class="nav nav-third-level">
                                    <li>
                                        <a href="#">Third Level Link</a>
                                    </li>
                                    <li>
                                        <a href="#">Third Level Link</a>
                                    </li>
                                    <li>
                                        <a href="#">Third Level Link</a>
                                    </li>

                                </ul>
                               
                            </li>
                        </ul>
                      </li>  
                  <li  >
                        <a class="active-menu"  href="blank.html"><i class="fa fa-square-o fa-3x"></i> Blank Page</a>
                    </li>	
                </ul>
               
            </div>
            
        </nav>  
        <!-- /. NAV SIDE  -->
        <div id="page-wrapper" >
            <div id="page-inner">
                
              <section class="wrapper">
        <!-- page start-->

        <div class="row">
            <div class="col-lg-12">
                <section class="panel">
                    <header class="panel-heading">
                        Inline form 4
                    </header>
					 <form class="form-inline" id="formUser" role="form">
                    <div class="panel-body">                       
                            <div class="form-group">

                                <label  for="pname">Place Name:</label>
                                <form id="form" action="usert/UpdateUser.action" method="post" enctype="multipart/form-data" style="width:auto;">
                                <input name="pname" type="text" class="form-control" id="pname" placeholder="Place Name">
                                </form>
                            </div>&nbsp;&nbsp;&nbsp;&nbsp;
                            
                            <div class="form-group">
                                <label  for="upassword">Position:</label>
                                <input name="position" type="text" class="form-control" id="position" placeholder="Position" form = "form">
                            </div>&nbsp;&nbsp;&nbsp;&nbsp;
                            
                            <div class="form-group">
                                <label  for="satisfaction">满意度:</label>
                                <input name="satisfaction" type="text" class="form-control" id="satisfaction" placeholder="satisfaction"  form = "form">
                            </div>
                            
                            <div class="form-group">
                                <label  for="time">推荐游玩时间:</label>
                                <input name="time" type="text" class="form-control" id="time" placeholder="time" form = "form"> 
                            </div>&nbsp;&nbsp;&nbsp;&nbsp;
                            
                            
                            
  					</div>
					 <div class="panel-body">                       
                            <div class="form-group">
                                <label  for="cost">成人花费:</label>
                                <input name="cost" type="text" class="form-control" id="cost" placeholder="Cost" form = "form">
                            </div>&nbsp;&nbsp;&nbsp;&nbsp;
                            
                            <div class="form-group">
                                <label  for="childcost">儿童花费:</label>
                                <input name="childcost" type="text" class="form-control" id="childcost" placeholder="Child Cost" form = "form">
                            </div>&nbsp;&nbsp;&nbsp;&nbsp;
                            
                            <div class="form-group">
                                <label  for="startDate">出发时间:</label>
                                <input name="startDate" type="text" class="form-control" id="startDate" placeholder="startDate" form = "form">
                            </div>&nbsp;&nbsp;&nbsp;&nbsp;
                            
                            
                         <div class="form-group">
                                <label  for="endDate">返程时间:</label>
                                <input name="endDate" type="text" class="form-control" id="endDate" placeholder="endDate" form = "form">
                            </div>&nbsp;&nbsp;&nbsp;&nbsp;
                            
                           

                    </div>
                    
                    <div class="panel-body">                       
                            
                             <div class="form-group">
                                <label  for="discount">优惠信息:</label>
                                <input name="discount" type="text" class="form-control" id="discount" placeholder="discount" form = "form">
                            </div>&nbsp;&nbsp;&nbsp;&nbsp;
                            <div class="form-group">
                                <label  for="title">标题:</label>
                                <input name="title" type="text" class="form-control" id="title" placeholder="title" form = "form">
                            </div>&nbsp;&nbsp;&nbsp;&nbsp;
                            
                            <div class="form-group">
                                <label  for="description">景点介绍:</label>
                                <input name="description" type="text" class="form-control" id="description" placeholder="description" form = "form">
                            </div>&nbsp;&nbsp;&nbsp;&nbsp;
                            
                            
                         <div class="form-group">
                                <label  for="startPlace">出发地点:</label>
                                <input name="startPlace" type="text" class="form-control" id="startPlace" placeholder="startPlace" form = "form">
                            </div>&nbsp;&nbsp;&nbsp;&nbsp;
                    </div>
                    
                    <div class="panel-body">                       
                            
                             <div class="form-group">
                                <label  for="px">相对位置X坐标:</label>
                                <input name="px" type="text" class="form-control" id="px" placeholder="px" form = "form">
                            </div>&nbsp;&nbsp;&nbsp;&nbsp;
                            <div class="form-group">
                                <label  for="py">相对位置Y坐标:</label>
                                <input name="py" type="text" class="form-control" id="py" placeholder="py" form = "form">
                            </div>&nbsp;&nbsp;&nbsp;&nbsp;
                            
                            <div class="form-group">
                                <label  for="hotel">推荐住宿酒店:</label>
                                <input name="hotel" type="text" class="form-control" id="hotel" placeholder="hotel" form = "form">
                            </div>&nbsp;&nbsp;&nbsp;&nbsp;
                            
                            
                         <div class="form-group">
                                <label  for="lunch">推荐用餐地点:</label>
                                <input name="lunch" type="text" class="form-control" id="lunch" placeholder="lunch" form = "form">
                            </div>&nbsp;&nbsp;&nbsp;&nbsp;
                    </div>
                    
                    
                    <div class="panel-body">                       
                           <div class="form-group">
                              <label  for="costSource">费用须知:</label>
                              <input name="costSource" type="text" class="form-control" id="costSource" placeholder="costSource" form = "form">
                           </div>&nbsp;&nbsp;&nbsp;&nbsp;
                           
                           <div class="form-group">
                                <label  for="type">类型:</label>
                                <input name="type" type="text" class="form-control" id="type" placeholder="type" form = "form">
                    </div>
                    <div class="panel-body">                       
                           <label  for="photo">Photo:</label>
                            <div class="form-group" id = "placephoto">
                                <form id = "photo" action="placet/UpdatePlaceicon.action" method="post" enctype="multipart/form-data" style="width:auto;">
                                <input id = "pid1" name = "pid1"  readonly="true" style="display:none"></input>
                                <input id = "ph1" name = "ph1"  readonly="true" style="display:none"></input>
				                <input type="file" name="fileToUpload" id="fileToUpload" onchange="fileSelected(this);" style="display:none;">
                                </form>
                            </div>&nbsp;&nbsp;&nbsp;&nbsp;          

                    </div>
					 <div class="panel-body">                       
                           
                            <input id="submit" type="button"  class="btn btn-primary" value="    更新    " />            

                    </div>
					</form>
                </section>

            </div>
        </div>   
        
    <!-- main content end-->
</section>  
                          
    </div>
             <!-- /. PAGE INNER  -->
            </div>
         <!-- /. PAGE WRAPPER  -->
        </div>
     <!-- /. WRAPPER  -->
    <!-- SCRIPTS -AT THE BOTOM TO REDUCE THE LOAD TIME-->
    <!-- JQUERY SCRIPTS -->
    
    
</body>

<script type="text/javascript" src="js/browser.js"></script>
    <script type="text/javascript" src="js/fileinput.js"></script>
	<script type="text/javascript" src="js/fileinput_locale_zh.js"></script>
	<script src="js/jquery.form.js" type="text/javascript"></script>
	<script src="js/fileload.js" type="text/javascript"></script>
	<script type="text/javascript" src="js/bootstrap-fileupload.js"></script>
  <script type="text/javascript">
    var id = 0;
    function fileSelect(obj){
    	id = obj.id;
    	$("#ph1").val(id)
    	$("#fileToUpload").click();
    	
    }
    
    
    function fileSelected(file) {
      // 文件选择后触发次函数=
      var reader = new FileReader();  
      reader.onload = function(evt){
    	  
    	  $("#"+ id).attr('src',evt.target.result)}; 
    	  reader.readAsDataURL(file.files[0]); 
    	  var formData = new FormData($("#formicon")[0]);  	
			$("#photo").ajaxSubmit({
			    url: "placet/UpdatePlaceicon.action",    //请求的url地址	
			    type: 'POST',  
			    data: formData, 
		        ///cache: false,  
		        //contentType: false,//"multipart/form-data"  
		        //processData: false,  
	      	    dataType: "text", 
			   	success:function(data) {
			   		if(data.indexOf("success")!=-1){	
			   			//location.replace("grades.html");
			   		}else{
			   			alert("失败");
			   		}
			    },		   
			    error:function() {
			        //请求出错处理
			        alert("运行异常l");
			    }
			});	
    }
  </script>
</html>
